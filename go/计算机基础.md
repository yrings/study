# 系统结构

## 虚拟地址是什么？

**虚拟内存**：虚拟内存是一种逻辑上扩充物理内存的技术。基本思想是用软、硬件技术把内存与外存这两级存储器当做一级存储器来用。虚拟内存技术的实现利用了自动覆盖和交换技术。简单的说就是将硬盘的一部分作为内存来使用。

**虚拟地址空间**：在32位的`i386 CPU`的地址总线的是32位的，也就是说可以寻找到`4G`的地址空间。我们的程序被CPU执行，就是在`0x00000000`到`0xFFFFFFFF`这一段地址中。高`2G`的空间为内核空间，由操作系统调用，低`2G`的空间为用户空间，由用户使用。

​	CPU在寻址的时候，是按照虚拟地址来寻址，然后通过**MMU(内存管理单元)**将虚拟地址转换为物理地址。因为只有程序的一部分加入到内存中，所以会出现所寻找的地址不在内存中的情况（CPU产生缺页异常），如果在内存不足的情况下，就会通过页面调度算法来将内存中的页面置换出来，然后将在外存中的页面加入到内存中，使程序继续正常运行。





## 用户态与内核态之间切换